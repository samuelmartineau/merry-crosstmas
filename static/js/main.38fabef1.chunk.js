(this["webpackJsonpmerry-crosstmas-client"]=this["webpackJsonpmerry-crosstmas-client"]||[]).push([[0],{131:function(e,t,n){e.exports=n(252)},251:function(e,t,n){},252:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"sendMails",(function(){return w})),n.d(a,"default",(function(){return k}));var r=n(0),o=n.n(r),c=n(7),i=n.n(c),l=n(119),s=n(292),u=n(12),d=n(254),m=n(256),p=n(291),f=n(5),b=Object(f.a)((function(){return{header:{textAlign:"center",margin:"2em 0"},headerIcon:{verticalAlign:"middle",height:"auto",width:"3rem",padding:"0.2em"},headerTitle:{fontSize:"3rem",margin:0,display:"flex",alignItems:"center",justifyContent:"center"},headerLinetag:{fontWeight:700,margin:".5em 0","&:after":{background:"white",content:"",display:"block",height:"2px",margin:"1.5em auto 0",position:"relative",width:"50%"}}}}))((function(e){var t=e.classes;return o.a.createElement("header",{className:t.header},o.a.createElement("h1",{className:t.headerTitle},o.a.createElement("svg",{className:t.headerIcon,version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14"},o.a.createElement("path",{d:"M5.203 3.758q-0.469 0.719-1.070 2.133-0.172-0.352-0.289-0.566t-0.316-0.496-0.398-0.441-0.492-0.273-0.637-0.113h-1.75q-0.109 0-0.18-0.070t-0.070-0.18v-1.5q0-0.109 0.070-0.18t0.18-0.070h1.75q1.953 0 3.203 1.758zM14 10q0 0.109-0.070 0.18l-2.5 2.5q-0.070 0.070-0.18 0.070-0.102 0-0.176-0.074t-0.074-0.176v-1.5q-0.25 0-0.664 0.004t-0.633 0.008-0.57-0.008-0.555-0.039-0.5-0.082-0.492-0.145-0.453-0.223-0.461-0.312-0.43-0.418-0.438-0.543q0.461-0.727 1.062-2.133 0.172 0.352 0.289 0.566t0.316 0.496 0.398 0.441 0.492 0.273 0.637 0.113h2v-1.5q0-0.109 0.070-0.18t0.18-0.070q0.094 0 0.187 0.078l2.492 2.492q0.070 0.070 0.070 0.18zM14 3q0 0.109-0.070 0.18l-2.5 2.5q-0.070 0.070-0.18 0.070-0.102 0-0.176-0.074t-0.074-0.176v-1.5h-2q-0.375 0-0.68 0.117t-0.539 0.352-0.398 0.48-0.352 0.605q-0.25 0.484-0.609 1.336-0.227 0.516-0.387 0.867t-0.422 0.82-0.5 0.781-0.578 0.648-0.703 0.535-0.832 0.328-1 0.129h-1.75q-0.109 0-0.18-0.070t-0.070-0.18v-1.5q0-0.109 0.070-0.18t0.18-0.070h1.75q0.375 0 0.68-0.117t0.539-0.352 0.398-0.48 0.352-0.605q0.25-0.484 0.609-1.336 0.227-0.516 0.387-0.867t0.422-0.82 0.5-0.781 0.578-0.648 0.703-0.535 0.832-0.328 1-0.129h2v-1.5q0-0.109 0.070-0.18t0.18-0.070q0.094 0 0.187 0.078l2.492 2.492q0.070 0.070 0.070 0.18z"})),o.a.createElement("span",null,"Merry Crosstmas")),o.a.createElement("p",{className:t.headerLinetag},"Receive an email to organize a Secret Santa with your friends"))})),g=Object(f.a)((function(e){return{title:{marginTop:"1em",textAlign:"center",fontSize:"1.5rem",textShadow:"1px 1px white",padding:"0 .5em"}}}))((function(e){var t=e.classes,n=e.children;return o.a.createElement("h2",{className:t.title},n)})),h=n(18),E=n.n(h),v=n(16),O=Object(f.a)({toolbar:{background:"#00e4ff"}})((function(e){var t=e.classes;return o.a.createElement("div",{id:"toolbar",className:t.toolbar},o.a.createElement("select",{className:"ql-size",defaultValue:""},o.a.createElement("option",{value:"10px"},"Small"),o.a.createElement("option",{value:""},"Normal"),o.a.createElement("option",{value:"32px"},"Big"),o.a.createElement("option",{value:"50px"},"Huge")),o.a.createElement("button",{className:"ql-bold"}),o.a.createElement("button",{className:"ql-italic"}),o.a.createElement("button",{className:"ql-underline"}),o.a.createElement("button",{className:"ql-list",value:"bullet"}),o.a.createElement("select",{className:"ql-align",defaultValue:""},o.a.createElement("option",{value:"center"}),o.a.createElement("option",{value:"left"}),o.a.createElement("option",{value:"right"}),o.a.createElement("option",{value:"justify"})),o.a.createElement("select",{className:"ql-color",defaultValue:""},h.Toolbar.defaultColors.map((function(e){return o.a.createElement("option",{value:e.value,key:e.value})}))),o.a.createElement("select",{className:"ql-background",defaultValue:""},h.Toolbar.defaultColors.map((function(e){return o.a.createElement("option",{value:e.value,key:e.value})}))),o.a.createElement("button",{className:"ql-clean"}))})),y=n(21),j=n(108);function N(e){return e.json()}var x=Object({NODE_ENV:"production",PUBLIC_URL:"merry-crosstmas"}).REACT_APP_API||"";function C(e){return e.status>=200&&e.status<300?N(e):429===e.status?Promise.reject(new Error("Too Many Requests")):N(e).then((function(e){return Promise.reject(new Error(e.message))}))}var w=function(e,t){return fetch("".concat(x,"/send"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contacts:e,content:t})}).then(C)},k=w,T=n(34),I=n(121),A=n(120),S=n(26),_=n(29),q=n(75),M=n.n(q),z="RESET",R=0;function D(){return R+=1}function L(e){var t=M()();return{name:"",email:"",forbidden:[],id:e,color:M()(t)}}var F=Array(3).fill().map((function(){return L(D())})),G=F.reduce((function(e,t){return Object.assign(e,Object(_.a)({},t.id,t))}),{}),P=F.map((function(e){return e.id})),V=function(e,t){return e[t]},Q={sending:!1,sended:!1,error:!1},B=Object(y.c)({map:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_CHAR":return Object(S.a)({},e,Object(_.a)({},t.id,Object(S.a)({},e[t.id],Object(_.a)({},t.key,t.value))));case"ADD_CONTACT":var n=L(t.id);return Object(S.a)({},e,Object(_.a)({},n.id,n));case"REMOVE_CONTACT":var a=t.id,r=(e[a],Object(I.a)(e,[a].map(A.a)));return r;case"TOGGLE_FORBIDDEN":var o,c=t.contactId,i=t.forbiddenId,l=e[c],s=l.forbidden.indexOf(i);return o=s>-1?[].concat(Object(T.a)(l.forbidden.slice(0,s)),Object(T.a)(l.forbidden.slice(s+1))):[].concat(Object(T.a)(l.forbidden),[i]),Object(S.a)({},e,Object(_.a)({},c,Object(S.a)({},l,{forbidden:o})));case z:return G;default:return e}},all:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_CONTACT":return[].concat(Object(T.a)(e),[t.id]);case"REMOVE_CONTACT":var n=e.indexOf(t.id);return[].concat(Object(T.a)(e.slice(0,n)),Object(T.a)(e.slice(n+1)));case z:return P;default:return e}},customMode:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_MODE":return!e;case z:return!1;default:return e}},status:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MAIL_SENDING":return{sending:!0,sended:!1,error:!1};case"MAIL_SUCCESS":return{sending:!1,sended:!0,error:!1};case"MAIL_ERROR":return{sending:!1,sended:!1,error:!0};case z:return Q;default:return e}}}),U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{show:!1,kind:null,message:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return{show:!0,kind:t.kind,message:t.message};case"CLOSE_NOTIFICATION":return{show:!1,kind:null,message:""};default:return e}},W='\n<p style="text-align: center;"><span style="font-size: 32px;">Hello </span><strong style="font-size: 50px; color: rgb(230, 0, 0);">@you</strong><span style="font-size: 32px;">!!!</span></p><p style="text-align: center;"><br></p><p>Do you remember when we decided to set up a <span style="font-size: 32px; color: rgb(0, 138, 0);">S</span><span style="font-size: 32px; color: rgb(230, 0, 0);">e</span><span style="font-size: 32px; color: rgb(0, 138, 0);">c</span><span style="font-size: 32px; color: rgb(230, 0, 0);">r</span><span style="font-size: 32px; color: rgb(0, 138, 0);">e</span><span style="font-size: 32px; color: rgb(230, 0, 0);">t</span><span style="font-size: 32px;"> </span><span style="font-size: 32px; color: rgb(0, 138, 0);">S</span><span style="font-size: 32px; color: rgb(230, 0, 0);">a</span><span style="font-size: 32px; color: rgb(0, 138, 0);">n</span><span style="font-size: 32px; color: rgb(230, 0, 0);">t</span><span style="font-size: 32px; color: rgb(0, 138, 0);">a</span> with a budget of <strong>20$</strong> ?</p><p>You have to find a gift for <u style="color: rgb(0, 138, 0); font-size: 32px;">@friend</u><span style="color: rgb(0, 138, 0); font-size: 32px;"> </span></p><p><br></p><p>See you at the end of the year:</p><p><br></p><p style="text-align: center;"><span style="font-size: 50px;">\ud83d\ude18\ud83c\udf84\ud83c\udf85\ud83c\udf89\ud83c\udf70\ud83c\udf7e</span></p>\n',H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"EDIT_MESSAGE":return t.message;case z:return W;default:return e}},J=Object(y.c)({contacts:B,notifications:U,editor:H}),X=function(e,t){return V(e.contacts.map,t)},Y=function(e,t){return function(e,t){var n=V(e.map,t);return e.all.filter((function(e){return e!==t})).map((function(t){return Object(S.a)({},V(e.map,t),{isForbidden:n.forbidden.includes(t)})}))}(e.contacts,t)},$=n(76),K=n.n($),Z=n(109),ee=n(110),te=n.n(ee),ne=function(e,t){return{type:"SET_NOTIFICATION",kind:e,message:t}},ae=function(){return{type:"MAIL_SENDING"}},re=function(){return{type:"MAIL_SUCCESS"}},oe=function(){return{type:"MAIL_ERROR"}};var ce=function(e){return{type:"EDIT_MESSAGE",message:e}};function ie(){return function(e,t){return e((n=t().contacts.map,a=t().editor,function(){var e=Object(Z.a)(K.a.mark((function e(t,r,o){var c,i,l;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=o.sendMails,i=Object.values(n),l=i.map((function(e){return e.email})),te()(l).length===l.length){e.next=8;break}t(ne("error","Emails should be uniq")),e.next=19;break;case 8:return t(ae()),e.prev=9,e.next=12,c(i.map((function(e){return{id:e.id,forbidden:e.forbidden,name:e.name,email:e.email}})),a);case 12:t(re()),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(9),t(oe()),t(ne("error",e.t0.message));case 19:case"end":return e.stop()}}),e,null,[[9,15]])})));return function(t,n,a){return e.apply(this,arguments)}}()));var n,a}}n(244);var le=h.Quill.import("attributors/style/background"),se=h.Quill.import("attributors/style/color"),ue=h.Quill.import("attributors/style/size"),de=h.Quill.import("attributors/style/align");ue.whitelist.push("50px"),h.Quill.register(le,!0),h.Quill.register(se,!0),h.Quill.register(ue,!0),h.Quill.register(de,!0);var me={toolbar:"#toolbar"},pe=["size","header","bold","italic","underline","color","background","list","bullet","align"],fe=Object(v.a)(Object(u.b)((function(e){return{message:e.editor}}),(function(e){return{onEdit:function(t){e(ce(t))}}})),Object(f.a)({testEditor:{background:"white"}}))((function(e){var t=e.classes,n=e.message,a=e.onEdit;return o.a.createElement("div",{className:t.testEditor},o.a.createElement(O,null),o.a.createElement(E.a,{modules:me,formats:pe,value:n,onChange:a}))})),be=Object(f.a)((function(){return{footer:{padding:"1em",textAlign:"center"}}}))((function(e){var t=e.classes;return o.a.createElement("footer",{className:t.footer},o.a.createElement("a",{href:"http://samuelmartineau.com",rel:"noopener noreferrer",target:"_blank"},"\xa9 Samuel Martineau"))})),ge=n(116),he=n(290),Ee=n(296),ve=n(286),Oe=n(288),ye=n(293),je=n(289),Ne=n(113),xe=n.n(Ne),Ce=n(111),we=n.n(Ce),ke=n(112),Te=n.n(ke),Ie=n(287),Ae=Object(v.a)(Object(u.b)((function(e,t){var n=t.contactId;return{forbidden:Y(e,n),onlyOne:1===Y(e,n).filter((function(e){return!e.isForbidden})).length}}),(function(e,t){var n=t.contactId;return{onToggle:function(t){return function(){return e(function(e,t){return{type:"TOGGLE_FORBIDDEN",contactId:e,forbiddenId:t}}(n,t))}}}})),Object(f.a)((function(e){return Object(ve.a)({root:{margin:e.spacing()},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:"0.2em"}})})))((function(e){var t=e.forbidden,n=e.classes,a=e.onToggle,r=e.onlyOne;return o.a.createElement("section",{className:n.root},o.a.createElement("p",null,"Toggle name to disable ability to be drawn"),o.a.createElement("article",{className:n.chips},t.map((function(e){return o.a.createElement(Ie.a,{key:e.id,className:n.chip,disabled:r&&!e.isForbidden,raised:!e.isForbidden,onClick:a(e.id),style:e.isForbidden?{color:"grey"}:{background:e.color,color:Te()(e.color),opacity:e.isForbidden?1:.5}},e.name)}))))})),Se=Object(v.a)(Object(u.b)((function(e,t){var n=t.contactId;return{contact:X(e,n),customMode:e.contacts.customMode}}),(function(e,t){return{onChar:function(n){return function(a){return e(function(e,t,n){return{type:"ADD_CHAR",key:t,id:e,value:n}}(t.contactId,n,a.target.value))}},onRemove:function(){e({type:"REMOVE_CONTACT",id:t.contactId})}}})),Object(f.a)((function(e){return Object(ve.a)({paper:{margin:"1em auto","&:after":{content:'" "',display:"table"}},container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(),marginRight:e.spacing(),flexGrow:1},button:{margin:e.spacing(),position:"absolute",right:0,zIndex:1}})})))((function(e){var t=e.contact,n=e.classes,a=e.onChar,r=e.onRemove,c=e.isRemovable,i=e.customMode;return o.a.createElement(Oe.a,{className:n.paper},c&&o.a.createElement(je.a,{className:n.button,"aria-label":"Delete",onClick:r},o.a.createElement(xe.a,null)),o.a.createElement("div",{className:n.container,style:{background:we()(t.color).fade(.5)}},o.a.createElement(ye.a,{label:"Name",placeholder:"Toto",className:n.textField,name:"name-".concat(t.id),margin:"normal",value:t.name,onChange:a("name"),required:!0}),o.a.createElement(ye.a,{label:"Email",placeholder:"toto@gmail.com",className:n.textField,margin:"normal",name:"email-".concat(t.id),type:"email",value:t.email,onChange:a("email"),required:!0})),i&&o.a.createElement(Ae,{contactId:t.id}))})),_e=n(114),qe=n.n(_e),Me=n(115),ze=n.n(Me),Re=Object(v.a)(Object(u.b)((function(e){return{canAddContact:e.contacts.all.length<20}}),(function(e){return{onAdd:function(){e({type:"ADD_CONTACT",id:D()})}}})),Object(f.a)((function(e){return Object(ve.a)({root:{display:"flex",justifyContent:"space-around"},button:{margin:e.spacing()}})})))((function(e){var t=e.classes,n=e.onAdd,a=e.canAddContact;return o.a.createElement("div",{className:t.root},o.a.createElement(Ie.a,{fab:!0,color:"primary","aria-label":"add",className:t.button,onClick:n,disabled:!a},o.a.createElement(qe.a,null)),o.a.createElement(Ie.a,{fab:!0,color:"accent","aria-label":"edit",type:"submit",className:t.button},o.a.createElement(ze.a,null)))})),De=Object(v.a)(Object(u.b)((function(e){return{customMode:e.contacts.customMode,contacts:e.contacts.all}}),(function(e){return{swithMode:function(){e({type:"TOGGLE_MODE"})},onSend:function(t){t.preventDefault(),e(ie())}}})),Object(f.a)({root:{flexDirection:"column"},switchRoot:{margin:0},form:{overflow:"hidden"}}))((function(e){var t=e.contacts,n=e.classes,a=e.swithMode,r=e.customMode,c=e.onSend;return o.a.createElement("form",{className:n.form,onSubmit:c,autoComplete:"off",role:"presentation"},o.a.createElement(he.a,{className:n.switchRoot,control:o.a.createElement(Ee.a,{checked:r,onChange:a}),label:"Custom Mode (ie: exclusions)"}),o.a.createElement("div",{className:n.root},o.a.createElement(ge.a,{duration:200,easing:"ease-out"},t.map((function(e,n){return o.a.createElement(Se,{isRemovable:t.length>3,contactId:e,key:e,order:n,scrollTo:n>2&&n===t.length-1})})))),o.a.createElement(Re,null))})),Le=n(295),Fe=n(117),Ge=n.n(Fe),Pe=Object(v.a)(Object(u.b)((function(e){return Object(S.a)({},e.notifications)}),(function(e){return{onClose:function(){e({type:"CLOSE_NOTIFICATION"})}}})),Object(f.a)((function(e){return{close:{width:4*e.spacing(),height:4*e.spacing()},error:{background:"red"},success:{background:"green"}}})))((function(e){var t=e.show,n=e.message,a=e.classes,r=e.onClose,c=e.kind;return o.a.createElement(Le.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:t,SnackbarContentProps:{"aria-describedby":"message-id",classes:{root:a[c]}},message:o.a.createElement("span",{id:"message-id"},n),action:[o.a.createElement(je.a,{key:"close","aria-label":"Close",color:"inherit",className:a.close,onClick:r},o.a.createElement(Ge.a,null))]})})),Ve=n(118),Qe=n.n(Ve),Be=Object(v.a)(Object(u.b)((function(){return{}}),(function(e){return{onReset:function(){e({type:z})}}})),Object(f.a)((function(e){return Object(ve.a)({success:{padding:"1em",textAlign:"center",color:"green"},button:{margin:e.spacing()}})})))((function(e){var t=e.classes,n=e.onReset;return o.a.createElement(Oe.a,{className:t.success},o.a.createElement(Qe.a,{style:{width:100,height:100}}),o.a.createElement("h2",null,"Mails sent with success"),o.a.createElement(Ie.a,{onClick:n,color:"primary",className:t.button},"Manage another secret santa"))})),Ue=Object(u.b)((function(e){return{status:e.contacts.status}}))(Object(m.a)((function(e){return Object(d.a)({"@global":{body:{backgroundImage:"linear-gradient(60deg, rgba(255, 165, 150, .5) 5%, rgba(0, 228, 255, .35)), url('background.jpg')",backgroundAttachment:"fixed",backgroundPosition:"center center",backgroundRepeat:"no-repeat",backgroundSize:"cover"}},app:{overflow:"auto",marginBottom:"3em",marginLeft:"auto",marginRight:"auto",maxWidth:"600px"},progress:{margin:"0 ".concat(e.spacing(2),"px")},spinner:{textAlign:"center"}})}))((function(e){var t=e.classes,n=e.status;return o.a.createElement("section",{className:t.app},o.a.createElement(b,null),!n.sending&&!n.sended&&[o.a.createElement(g,{key:1},"Write your message and tag the buyer with @you and recipient with @friend."),o.a.createElement(fe,{key:2}),o.a.createElement(g,{key:3},"Complete your friends informations (minimum 3 people)"),o.a.createElement(De,{key:4}),o.a.createElement(be,{key:5})],n.sending&&o.a.createElement("div",{className:t.spinner},o.a.createElement(p.a,{className:t.progress,color:"primary",size:100})),n.sended&&o.a.createElement(Be,null),o.a.createElement(Pe,null))})));n(251);n(253).initialize("UA-65391889-2");var We=Object(l.a)({spacing:8});i.a.render(o.a.createElement(u.a,{store:Object(y.e)(J,(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||y.d)(Object(y.a)(j.a.withExtraArgument(a))))},o.a.createElement(s.a,{theme:We},o.a.createElement(Ue,null))),document.getElementById("root"))}},[[131,1,2]]]);
//# sourceMappingURL=main.38fabef1.chunk.js.map